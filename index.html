<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Learning Targets Checklist</title>
  <style>
    :root { --max: 760px; }
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 0; background: #f6f7f9; }
    .wrap { max-width: var(--max); margin: 24px auto; padding: 16px; }
    .card { background: #fff; border-radius: 16px; padding: 18px; box-shadow: 0 6px 18px rgba(0,0,0,.08); }
    h1 { font-size: 1.25rem; margin: 0 0 6px; }
    .meta { color: #555; font-size: .95rem; margin: 0 0 14px; }
    ul { list-style: none; padding: 0; margin: 0; }
    li { display: flex; gap: 10px; align-items: flex-start; padding: 10px 0; border-top: 1px solid #eee; }
    li:first-child { border-top: none; }
    input[type="checkbox"] { margin-top: 2px; width: 18px; height: 18px; }
    label { cursor: pointer; line-height: 1.25; }
    .btnrow { display: flex; gap: 10px; margin-top: 14px; flex-wrap: wrap; }
    button {
      border: 1px solid #ddd; background: #fff; padding: 10px 12px; border-radius: 12px;
      cursor: pointer; font-size: .95rem;
    }
    button:hover { background: #f2f3f5; }
    .note { color: #666; font-size: .9rem; margin-top: 10px; }
    .error { color: #b00020; font-weight: 600; }
    .pill { display:inline-block; padding: 2px 10px; border-radius: 999px; background:#eef2ff; color:#2b2f77; font-size:.85rem; }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card" role="region" aria-label="Learning targets checklist">
      <h1 id="title">Learning Targets</h1>
      <p class="meta">
        <span class="pill" id="pill"></span>
        <span id="subtitle"></span>
      </p>

      <div id="content"></div>

      <div class="btnrow" id="buttons" style="display:none;">
        <button type="button" id="resetBtn">Reset this checklist</button>
      </div>

      <p class="note" id="note" style="display:none;">
        Checks are saved on <strong>this device/browser</strong>. If you switch devices or clear browser data, they may reset.
      </p>
    </div>
  </div>

<script>
(() => {
  // ------------- SAMPLE DATA (replace with your real weekly targets) -------------
  // You can keep adding weeks/courses here without making more pages.
  const TARGETS = {
    S1: {
      name: "Spanish 1",
      weeks: {
        1: [
          "I can greet someone and say goodbye politely.",
          "I can ask and answer “How are you?”",
          "I can introduce myself with my name."
        ],
        7: [
          "I can describe what I do in class using -ar verbs.",
          "I can ask for help and clarification in Spanish.",
          "I can tell what materials I need (book, pencil, paper)."
        ]
      }
    },
    S2: {
      name: "Spanish 2",
      weeks: {
        5: [
          "I can talk about chores I do at home.",
          "I can say how often I do chores (siempre, a veces, nunca).",
          "I can explain who does what in my family using pronouns."
        ]
      }
    },
    S3: {
      name: "Spanish 3",
      weeks: {
        2: [
          "I can narrate a past experience using the preterite.",
          "I can connect events with sequence words (primero, luego, después).",
          "I can describe how I felt during a past event."
        ]
      }
    },
    S4: {
      name: "Spanish 4",
      weeks: {
        3: [
          "I can interpret a short authentic text and identify the main idea.",
          "I can support opinions with evidence from the text.",
          "I can compare cultural perspectives using specific examples."
        ]
      }
    }
  };

  // ------------- READ URL PARAMETERS -------------
  const params = new URLSearchParams(window.location.search);
  const course = (params.get("course") || "").toUpperCase(); // e.g., S1
  const week = params.get("week"); // e.g., 7
  const weekNum = week ? String(parseInt(week, 10)) : "";

  // ------------- FIND TARGETS -------------
  const courseObj = TARGETS[course];
  const items = courseObj?.weeks?.[weekNum];

  const titleEl = document.getElementById("title");
  const subtitleEl = document.getElementById("subtitle");
  const pillEl = document.getElementById("pill");
  const contentEl = document.getElementById("content");
  const buttonsEl = document.getElementById("buttons");
  const noteEl = document.getElementById("note");

  // Set header pill
  pillEl.textContent = courseObj ? courseObj.name : "Checklist";

  if (!courseObj || !items) {
    titleEl.textContent = "Checklist not found";
    subtitleEl.innerHTML = ` <span class="error">Missing or invalid link parameters.</span>`;
    contentEl.innerHTML = `
      <p>Try a URL like:</p>
      <ul>
        <li><code>?course=S1&week=7</code></li>
        <li><code>?course=S3&week=2</code></li>
      </ul>
    `;
    return;
  }

  titleEl.textContent = "Learning Targets";
  subtitleEl.textContent = ` — Week ${weekNum}`;

  // ------------- PERSISTENCE KEY -------------
  // This makes checks separate per course+week.
  const storageKey = `targets:${course}:week:${weekNum}`;

  // Load saved state or initialize
  let state = {};
  try {
    state = JSON.parse(localStorage.getItem(storageKey)) || {};
  } catch {
    state = {};
  }

  // ------------- RENDER CHECKLIST -------------
  const ul = document.createElement("ul");

  items.forEach((text, idx) => {
    const id = `cb_${course}_${weekNum}_${idx}`;

    const li = document.createElement("li");

    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.id = id;
    cb.checked = !!state[idx];

    cb.addEventListener("change", () => {
      state[idx] = cb.checked;
      localStorage.setItem(storageKey, JSON.stringify(state));
    });

    const label = document.createElement("label");
    label.htmlFor = id;
    label.textContent = text;

    li.appendChild(cb);
    li.appendChild(label);
    ul.appendChild(li);
  });

  contentEl.appendChild(ul);
  buttonsEl.style.display = "flex";
  noteEl.style.display = "block";

  // ------------- RESET -------------
  document.getElementById("resetBtn").addEventListener("click", () => {
    if (!confirm("Reset all checks for this week?")) return;
    state = {};
    localStorage.removeItem(storageKey);
    [...ul.querySelectorAll('input[type="checkbox"]')].forEach(cb => cb.checked = false);
  });
})();
</script>
</body>
</html>
