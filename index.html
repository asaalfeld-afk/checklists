<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Objetivos</title>

  <style>
    :root { --max: 760px; }

    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      margin: 0;
      background: #eef7f4; /* light tint of #0c8571 */
    }

    .wrap {
      max-width: var(--max);
      margin: 24px auto;
      padding: 16px;
    }

    .card {
      background: #ffffff;
      border-radius: 16px;
      padding: 18px;
      box-shadow: 0 8px 22px rgba(12, 133, 113, 0.12);
    }

    h1 {
      font-size: 1.4rem;
      margin: 0 0 6px;
    }

    .meta {
      color: #555;
      font-size: .95rem;
      margin-bottom: 14px;
    }

    .pill {
      display: inline-block;
      padding: 2px 10px;
      border-radius: 999px;
      background: #eef2ff;
      color: #2b2f77;
      font-size: .85rem;
      margin-right: 6px;
    }

    .stem {
      margin: 12px 0 18px;
      padding: 12px 14px;
      background: #f2f4f8;
      border-left: 4px solid #0c8571;
      border-radius: 10px;
      font-weight: 600;
    }

    ul {
      list-style: none;
      padding: 0;
      margin: 0;
    }

    li {
      display: flex;
      gap: 10px;
      align-items: flex-start;
      padding: 10px 0;
      border-top: 1px solid #eee;
    }

    li:first-child {
      border-top: none;
    }

    input[type="checkbox"] {
      margin-top: 2px;
      width: 18px;
      height: 18px;
      cursor: pointer;
    }

    label {
      cursor: pointer;
      line-height: 1.3;
    }

    .btnrow {
      display: flex;
      gap: 10px;
      margin-top: 14px;
      flex-wrap: wrap;
    }

    button {
      border: 1px solid #ddd;
      background: #ffffff;
      padding: 10px 12px;
      border-radius: 12px;
      cursor: pointer;
      font-size: .95rem;
    }

    button:hover {
      background: #f2f3f5;
    }

    .note {
      color: #666;
      font-size: .9rem;
      margin-top: 10px;
    }

    .error {
      color: #b00020;
      font-weight: 600;
    }

    code { font-size: .95em; }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="card" role="region" aria-label="Objetivos checklist">

      <h1>ðŸŽ¯ Objetivos</h1>

      <p class="meta">
        <span class="pill" id="pill"></span>
        <span id="subtitle"></span>
      </p>

      <div class="stem">
        Sin usar apuntes, puedoâ€¦
      </div>

      <div id="content">Loadingâ€¦</div>

      <div class="btnrow" id="buttons" style="display:none;">
        <button type="button" id="resetBtn">Reiniciar esta lista</button>
      </div>

      <p class="note" id="note" style="display:none;">
        Las casillas se guardan en <strong>este dispositivo/navegador</strong>.
      </p>

    </div>
  </div>

<script>
(() => {

  /* =======================
     EDIT OBJECTIVES HERE
     ======================= */

  const TARGETS = {
    S1: {
      name: "Spanish 1",
      semesters: {
        1: {
          weeks: {
            1: [
              "access Spanish class in Canvas"
            ],
            2: [
              "introduce myself in Spanish",
              "greet teachers and other students appropriately",
              "recognize 5 or more letters of the alphabet"
            ],
            3: [
              "introduce myself in Spanish",
              "greet teachers and other students appropriately",
              "spell my name",
              "recognize 10 or more letters of the alphabet",
              "exchange email addresses (using notes)"
            ],
            4: [
              "introduce myself in Spanish",
              "greet teachers and other students appropriately",
              "spell my name",
              "recognize 15 or more letters of the alphabet",
              "say how old I am",
              "exchange email addresses",
              "exchange phone numbers",
              "recognize numbers 0â€“99 when I hear them (using notes)"
            ]
          }
        },
        2: {
          weeks: {
            1: [
              "match a picture to its description in Spanish",
              "recognize 25 or more vocab words without using notes",
              "interpret present tense verb endings"
            ],
            2: [
              "recognize 30 or more vocab words without using notes",
              "say where I go on a typical weekend",
              "interpret present tense verb endings",
              "interpret informational texts in Spanish"
            ],
            3: [
              "recognize 35 or more vocab words without using notes",
              "say what my friends and I do on a typical weekend",
              "interpret present tense verb endings",
              "interpret informational texts in Spanish"
            ],
            U3: [
              "describe my daily and weekly activities",
              "describe the daily and weekly activities of people around me",
              "talk about what I like to do and donâ€™t like to do",
              "understand spoken and written descriptions of peopleâ€™s activities when given in simple language",
              "start to communicate in complete sentences",
              "interpret meaning differences in different verb endings"
            ]
          }
        }
      }
    },

    S2: { name: "Spanish 2", semesters: { 1: { weeks: {} }, 2: { weeks: {} } } },
    S3: { name: "Spanish 3", semesters: { 1: { weeks: {} }, 2: { weeks: {} } } },
    S4: { name: "Spanish 4", semesters: { 1: { weeks: {} }, 2: { weeks: {} } } }
  };

  /* =======================
     DO NOT EDIT BELOW
     ======================= */

  const params = new URLSearchParams(window.location.search);

  const course = (params.get("course") || "").trim().toUpperCase();

  // Robust semester parsing: accept sem=2 OR sem=S2 (Canvas naming collision)
  const semRaw = (params.get("sem") || "").trim().toUpperCase();
  const semNum = (semRaw === "2" || semRaw === "S2") ? "2" : "1";

  const weekRaw = params.get("week");
  const weekKey = weekRaw ? String(weekRaw).trim() : "";

  const pillEl = document.getElementById("pill");
  const subtitleEl = document.getElementById("subtitle");
  const contentEl = document.getElementById("content");
  const buttonsEl = document.getElementById("buttons");
  const noteEl = document.getElementById("note");

  const courseObj = TARGETS[course];
  const items = courseObj?.semesters?.[semNum]?.weeks?.[weekKey];

  pillEl.textContent = courseObj ? courseObj.name : "Objetivos";

  if (!courseObj || !weekKey || !items) {
    subtitleEl.innerHTML = `<span class="error">Curso/semestre/semana no vÃ¡lidos.</span>`;
    contentEl.innerHTML = `
      <p>Ejemplos de enlaces:</p>
      <ul>
        <li><code>?course=S1&sem=1&week=4</code></li>
        <li><code>?course=S1&sem=2&week=1</code></li>
        <li><code>?course=S1&sem=2&week=U3</code></li>
      </ul>
    `;
    return;
  }

  subtitleEl.textContent = `Â· Semestre ${semNum} Â· Semana ${weekKey}`;

  const storageKey = `targets:${course}:sem${semNum}:week${weekKey}`;
  let state = {};

  try {
    state = JSON.parse(localStorage.getItem(storageKey)) || {};
  } catch {
    state = {};
  }

  const ul = document.createElement("ul");

  items.forEach((text, idx) => {
    const id = `cb_${course}_${semNum}_${weekKey}_${idx}`;

    const li = document.createElement("li");

    const cb = document.createElement("input");
    cb.type = "checkbox";
    cb.id = id;
    cb.checked = !!state[idx];

    cb.addEventListener("change", () => {
      state[idx] = cb.checked;
      localStorage.setItem(storageKey, JSON.stringify(state));
    });

    const label = document.createElement("label");
    label.htmlFor = id;
    label.textContent = text;

    li.appendChild(cb);
    li.appendChild(label);
    ul.appendChild(li);
  });

  contentEl.innerHTML = "";
  contentEl.appendChild(ul);

  buttonsEl.style.display = "flex";
  noteEl.style.display = "block";

  document.getElementById("resetBtn").addEventListener("click", () => {
    if (!confirm("Â¿Reiniciar esta lista?")) return;
    state = {};
    localStorage.removeItem(storageKey);
    ul.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
  });

})();
</script>
</body>
</html>
